<html>
<head>
<title>Spice-XPI test page (generated)</title>
<style type="text/css">
caption {
    text-align: left;
    font-weight: bold;
}

th {
    text-align: left;
}
</style>
</head>

<body onload="bodyLoad()" onunload="bodyUnload()">

<center>
<h1>SPICE xpi test page (generated)</h1>
This page was autogenerated using IDL description and should not be modified by hand.<br>
Disabled (greyed out) values are passed
to SPICE xpi as empty variables.
</center>
<br/>

<embed type="application/x-spice" width="0" height="0" id="spice-xpi"/><br/>

<script type="text/javascript">

var embed = document.getElementById("spice-xpi");

function bodyLoad()
{
    log("Body Load");
};

function bodyUnload()
{
    log("Body Unload");
}

function connect()
{
    setConnectVars();
    SetUsbFilter();
    embed.connect();
    log("Connect: host '" + embed.hostIP + "', port '" + embed.port
        + "', secure port '" + embed.SecurePort + "', USB port '" +
        embed.UsbListenPort + "'");
}

function disconnect()
{
    embed.disconnect();
    log("Disconnect");
}

function OnDisconnected(msg)
{
    log("Disconnected, return code: " + msg);
}

function log(message)
{
    var log = document.getElementById("log");
    var ts = new Date().toString() + ": ";
    var newRow = document.createElement("tr");
    var tsCell = document.createElement("td");
    var msgCell = document.createElement("td");

    tsCell.innerHTML = ts;
    msgCell.innerHTML = message;

    newRow.appendChild(tsCell);
    newRow.appendChild(msgCell);
    log.insertBefore(newRow, log.firstChild);
}

function setLanguageStrings()
{
    section = document.getElementById("SetLanguageStringssectionToggled").checked ?
        document.getElementById("SetLanguageStringssection").value : "";
    lang = document.getElementById("SetLanguageStringslangToggled").checked ?
        document.getElementById("SetLanguageStringslang").value : "";
    embed.SetLanguageStrings(section, lang);
    log("Language Strings set to '" + section + "' '" + lang + "'");
}

function SetUsbFilter()
{
    UsbFilterToggled = document.getElementById("SetUsbFilterfilterToggled");
    if (!UsbFilterToggled)
        return;
    filter = UsbFilterToggled.checked ?
        document.getElementById("SetUsbFilterfilter").value : "";
    embed.SetUsbFilter(filter);
    log("USB Filter String set to: '" + filter + "'");
}

function show()
{
    embed.show();
    log("Show");
}

function ConnectedStatus()
{
    log("Connected status = " + embed.ConnectedStatus());
}

function toggle(checkboxID)
{
    var checkbox = document.getElementById(checkboxID);
    var toggle = document.getElementById(arguments[1]);
    toggle.disabled = !checkbox.checked;
}

function setConnectVars()
{
    embed.hostIP = document.getElementById("hostIPToggled").checked ? document.getElementById("hostIP").value : "";
    embed.port = document.getElementById("portToggled").checked ? document.getElementById("port").value : "";
    embed.SecurePort = document.getElementById("SecurePortToggled").checked ? document.getElementById("SecurePort").value : "";
    embed.Password = document.getElementById("PasswordToggled").checked ? document.getElementById("Password").value : "";
    embed.CipherSuite = document.getElementById("CipherSuiteToggled").checked ? document.getElementById("CipherSuite").value : "";
    embed.SSLChannels = document.getElementById("SSLChannelsToggled").checked ? document.getElementById("SSLChannels").value : "";
    embed.HostSubject = document.getElementById("HostSubjectToggled").checked ? document.getElementById("HostSubject").value : "";
    embed.fullScreen = document.getElementById("fullScreenToggled").checked ? document.getElementById("fullScreen").checked : "";
    embed.AdminConsole = document.getElementById("AdminConsoleToggled").checked ? document.getElementById("AdminConsole").checked : "";
    embed.Title = document.getElementById("TitleToggled").checked ? document.getElementById("Title").value : "";
    embed.dynamicMenu = document.getElementById("dynamicMenuToggled").checked ? document.getElementById("dynamicMenu").value : "";
    embed.NumberOfMonitors = document.getElementById("NumberOfMonitorsToggled").checked ? document.getElementById("NumberOfMonitors").value : "";
    embed.GuestHostName = document.getElementById("GuestHostNameToggled").checked ? document.getElementById("GuestHostName").value : "";
    embed.HotKey = document.getElementById("HotKeyToggled").checked ? document.getElementById("HotKey").value : "";
    embed.NoTaskMgrExecution = document.getElementById("NoTaskMgrExecutionToggled").checked ? document.getElementById("NoTaskMgrExecution").checked : "";
    embed.SendCtrlAltDelete = document.getElementById("SendCtrlAltDeleteToggled").checked ? document.getElementById("SendCtrlAltDelete").checked : "";
    embed.UsbListenPort = document.getElementById("UsbListenPortToggled").checked ? parseInt(document.getElementById("UsbListenPort").value) : "";
    embed.UsbAutoShare = document.getElementById("UsbAutoShareToggled").checked ? document.getElementById("UsbAutoShare").checked : "";
    embed.Smartcard = document.getElementById("SmartcardToggled").checked ? document.getElementById("Smartcard").checked : "";
    embed.ColorDepth = document.getElementById("ColorDepthToggled").checked ? document.getElementById("ColorDepth").value : "";
    embed.DisableEffects = document.getElementById("DisableEffectsToggled").checked ? document.getElementById("DisableEffects").value : "";
    embed.TrustStore = document.getElementById("TrustStoreToggled").checked ? document.getElementById("TrustStore").value : "";
    embed.Proxy = document.getElementById("ProxyToggled").checked ? document.getElementById("Proxy").value : "";
}

</script>

<center>

<table id="values">
<tr>
<td><input type="checkbox" id="hostIPToggled" onclick="toggle('hostIPToggled', 'hostIP')" checked/></td>
<td>Host IP</td>
<td><input id="hostIP" type="text" size="30" /></td>
</tr>
<tr>
<td><input type="checkbox" id="portToggled" onclick="toggle('portToggled', 'port')" checked/></td>
<td>Port</td>
<td><input id="port" type="text" size="30" /></td>
</tr>
<tr>
<td><input type="checkbox" id="SecurePortToggled" onclick="toggle('SecurePortToggled', 'SecurePort')" /></td>
<td>Secure Port</td>
<td><input id="SecurePort" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="PasswordToggled" onclick="toggle('PasswordToggled', 'Password')" /></td>
<td>Password</td>
<td><input id="Password" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="CipherSuiteToggled" onclick="toggle('CipherSuiteToggled', 'CipherSuite')" /></td>
<td>Cipher Suite</td>
<td><input id="CipherSuite" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="SSLChannelsToggled" onclick="toggle('SSLChannelsToggled', 'SSLChannels')" /></td>
<td>SSL Channels</td>
<td><input id="SSLChannels" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="HostSubjectToggled" onclick="toggle('HostSubjectToggled', 'HostSubject')" /></td>
<td>Host Subject</td>
<td><input id="HostSubject" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="fullScreenToggled" onclick="toggle('fullScreenToggled', 'fullScreen')" /></td>
<td>Full Screen</td>
<td><input id="fullScreen" type="checkbox" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="AdminConsoleToggled" onclick="toggle('AdminConsoleToggled', 'AdminConsole')" checked/></td>
<td>Admin Console</td>
<td><input id="AdminConsole" type="checkbox" size="30" checked /></td>
</tr>
<tr>
<td><input type="checkbox" id="TitleToggled" onclick="toggle('TitleToggled', 'Title')" /></td>
<td>Title</td>
<td><input id="Title" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="dynamicMenuToggled" onclick="toggle('dynamicMenuToggled', 'dynamicMenu')" /></td>
<td>Dynamic Menu</td>
<td><input id="dynamicMenu" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="NumberOfMonitorsToggled" onclick="toggle('NumberOfMonitorsToggled', 'NumberOfMonitors')" /></td>
<td>Number Of Monitors</td>
<td><input id="NumberOfMonitors" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="GuestHostNameToggled" onclick="toggle('GuestHostNameToggled', 'GuestHostName')" /></td>
<td>Guest Host Name</td>
<td><input id="GuestHostName" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="HotKeyToggled" onclick="toggle('HotKeyToggled', 'HotKey')" checked/></td>
<td>Hot Key</td>
<td><input id="HotKey" type="text" size="30" value="toggle-fullscreen=shift+f11,release-cursor=shift+f12,smartcard-insert=shift+f8,smartcard-remove=shift+f9" /></td>
</tr>
<tr>
<td><input type="checkbox" id="NoTaskMgrExecutionToggled" onclick="toggle('NoTaskMgrExecutionToggled', 'NoTaskMgrExecution')" /></td>
<td>No Task Mgr Execution</td>
<td><input id="NoTaskMgrExecution" type="checkbox" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="SendCtrlAltDeleteToggled" onclick="toggle('SendCtrlAltDeleteToggled', 'SendCtrlAltDelete')" /></td>
<td>Send Ctrl Alt Delete</td>
<td><input id="SendCtrlAltDelete" type="checkbox" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="UsbListenPortToggled" onclick="toggle('UsbListenPortToggled', 'UsbListenPort')" /></td>
<td>Usb Listen Port</td>
<td><input id="UsbListenPort" type="text" size="30" value="32023" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="UsbAutoShareToggled" onclick="toggle('UsbAutoShareToggled', 'UsbAutoShare')" /></td>
<td>Usb Auto Share</td>
<td><input id="UsbAutoShare" type="checkbox" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="SmartcardToggled" onclick="toggle('SmartcardToggled', 'Smartcard')" checked/></td>
<td>Smartcard</td>
<td><input id="Smartcard" type="checkbox" size="30" /></td>
</tr>
<tr>
<td><input type="checkbox" id="ColorDepthToggled" onclick="toggle('ColorDepthToggled', 'ColorDepth')" /></td>
<td>Color Depth</td>
<td><input id="ColorDepth" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="DisableEffectsToggled" onclick="toggle('DisableEffectsToggled', 'DisableEffects')" /></td>
<td>Disable Effects</td>
<td><input id="DisableEffects" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="TrustStoreToggled" onclick="toggle('TrustStoreToggled', 'TrustStore')" /></td>
<td>Trust Store</td>
<td><textarea id="TrustStore" cols="80" rows="10" disabled/></textarea></td>
</tr>
<tr>
<td><input type="checkbox" id="ProxyToggled" onclick="toggle('ProxyToggled', 'Proxy')" /></td>
<td>Proxy</td>
<td><input id="Proxy" type="text" size="30" disabled /></td>
</tr>
<tr>
<td><input type="checkbox" id="SetLanguageStringssectionToggled" onclick="toggle('SetLanguageStringssectionToggled', 'SetLanguageStringssection')" checked/></td>
<td>Set Language Strings - Section</td>
<td><input id="SetLanguageStringssection" type="text" size="30" /></td>
</tr>
<tr>
<td><input type="checkbox" id="SetLanguageStringslangToggled" onclick="toggle('SetLanguageStringslangToggled', 'SetLanguageStringslang')" checked/></td>
<td>Set Language Strings - Lang</td>
<td><input id="SetLanguageStringslang" type="text" size="30" /></td>
</tr>
<tr>
<td><input type="checkbox" id="SetUsbFilterfilterToggled" onclick="toggle('SetUsbFilterfilterToggled', 'SetUsbFilterfilter')" checked/></td>
<td>Set Usb Filter - Filter</td>
<td><input id="SetUsbFilterfilter" type="text" size="30" /></td>
</tr>
</table>

<br/>
<input type="button" value="Connect" style="min-width: 180px" onclick="connect()"/>
<input type="button" value="Show" style="min-width: 180px" onclick="show()"/>
<input type="button" value="Disconnect" style="min-width: 180px" onclick="disconnect()"/>
<br/>
<input type="button" value="Set Language Strings" style="min-width: 180px" onclick="SetLanguageStrings()"/>
<input type="button" value="Set Usb Filter" style="min-width: 180px" onclick="SetUsbFilter()"/>
<input type="button" value="Connected Status" style="min-width: 180px" onclick="ConnectedStatus()"/>

</center>

<hr/>
<table style="border: 1px; border-color: black;">
<caption>log:</caption>
<thead><tr><th style="width: 22em;">timestamp</th><th>message</th></tr></thead>
<tbody style="font-family: monospace;" id="log">
</tbody>
</table>
</body>
</html>
